<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(240, 240, 240); color: rgb(68, 68, 68);">int n,m,<span class="hljs-keyword" style="font-weight: 700;">q</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
int a[<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>][<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>]<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
int dp[<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>][<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>][<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>][<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>], max_zero_cols[<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>][<span class="hljs-number" style="color: rgb(136, 0, 0);">42</span>]<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
 
int main(){
	
	std::ios::sync_with_stdio(false)<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
	cin.tie(<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>)<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
 
	cin &gt;&gt; n &gt;&gt; m &gt;&gt; <span class="hljs-keyword" style="font-weight: 700;">q</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
	<span class="hljs-keyword" style="font-weight: 700;">for</span>(int i=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;i&lt;=n;i++){</span>
		<span class="hljs-keyword" style="font-weight: 700;">for</span>(int <span class="hljs-keyword" style="font-weight: 700;">j</span>=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;j&lt;=m;j++){</span>
			char c<span class="hljs-comment" style="color: rgb(136, 136, 136);">; cin &gt;&gt; c;</span>
			a[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>] = c-'<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>'<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
		}
	}
 
	<span class="hljs-keyword" style="font-weight: 700;">for</span>(int i=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;i&lt;=m;i++){</span>
		<span class="hljs-keyword" style="font-weight: 700;">for</span>(int <span class="hljs-keyword" style="font-weight: 700;">j</span>=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;j&lt;=n;j++){</span>
			max_zero_cols[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>] = (a[<span class="hljs-keyword" style="font-weight: 700;">j</span>][i]==<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span>)*(<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>+max_zero_cols[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>-<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>])<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
		}
	}
 
	<span class="hljs-keyword" style="font-weight: 700;">for</span>(int i=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;i&lt;=n;i++){</span>
		<span class="hljs-keyword" style="font-weight: 700;">for</span>(int <span class="hljs-keyword" style="font-weight: 700;">j</span>=i<span class="hljs-comment" style="color: rgb(136, 136, 136);">;j&lt;=n;j++){</span>
			<span class="hljs-keyword" style="font-weight: 700;">for</span>(int <span class="hljs-keyword" style="font-weight: 700;">k</span>=<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;k&lt;=m;k++){</span>
				<span class="hljs-keyword" style="font-weight: 700;">for</span>(int <span class="hljs-keyword" style="font-weight: 700;">l</span>=<span class="hljs-keyword" style="font-weight: 700;">k</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;l&lt;=m;l++){</span>
					dp[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>][<span class="hljs-keyword" style="font-weight: 700;">k</span>][<span class="hljs-keyword" style="font-weight: 700;">l</span>] = dp[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>-<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>][<span class="hljs-keyword" style="font-weight: 700;">k</span>][<span class="hljs-keyword" style="font-weight: 700;">l</span>] + dp[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>][<span class="hljs-keyword" style="font-weight: 700;">k</span>][<span class="hljs-keyword" style="font-weight: 700;">l</span>-<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>] - dp[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>-<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>][<span class="hljs-keyword" style="font-weight: 700;">k</span>][<span class="hljs-keyword" style="font-weight: 700;">l</span>-<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span>]<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
 
					int min_height = <span class="hljs-keyword" style="font-weight: 700;">j</span>-i+<span class="hljs-number" style="color: rgb(136, 0, 0);">1</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
					<span class="hljs-keyword" style="font-weight: 700;">for</span>(int p=<span class="hljs-keyword" style="font-weight: 700;">l</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;p&gt;=k;p--){</span>
						chmin(min_height, max_zero_cols[p][<span class="hljs-keyword" style="font-weight: 700;">j</span>])<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
						dp[i][<span class="hljs-keyword" style="font-weight: 700;">j</span>][<span class="hljs-keyword" style="font-weight: 700;">k</span>][<span class="hljs-keyword" style="font-weight: 700;">l</span>] += min_height<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
					}
				}
			}
		}
	}
 
 
	<span class="hljs-keyword" style="font-weight: 700;">for</span>(int qt=<span class="hljs-number" style="color: rgb(136, 0, 0);">0</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;qt&lt;q;qt++){</span>
		int a,b,c,<span class="hljs-keyword" style="font-weight: 700;">d</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">; cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span>
		cout &lt;&lt; dp[a][c][b][<span class="hljs-keyword" style="font-weight: 700;">d</span>] &lt;&lt; endl<span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
	}
 
	<span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: rgb(136, 0, 0);">0</span><span class="hljs-comment" style="color: rgb(136, 136, 136);">;</span>
}</pre>
